##%######################################################%##
#                                                          #
####   Délimitation des zones d'études                     ####
###                                                        ###
##             Date : Avril 2024                           ##
#                                                          #
##%######################################################%##

###---------------------------------------------------------#
#### Chargement de la couche shape file regroupant les coordonnées GPS des exploitations agricoles ####

coord_ea <- sf::st_read("Data/Spatiales/coord_ea.shp")

mapview(coord_ea)



#### Délimitation des rayons d'étude ####
cli::cli_h1("Rayon de 2km")
###---------------------------------------------------------#

rayon_2km <- creation_rayon(coord_ea, rayon = 2000)

cli::cli_h1("Rayon de 1km")
###---------------------------------------------------------#
rayon_1km <- creation_rayon(coord_ea, rayon = 1000)

mapview(coord_ea) +
  mapview(rayon_1km, col.regions = "green", alpha.regions = 0.4) +
  mapview(rayon_2km, col.regions = "red", alpha.regions = 0.2)

#### Sélection des données concernées ####
sinp_ea_2km <- sf::st_intersection(sinp,rayon_2km)
sinp_ea_1km <- sf::st_intersection(sinp,rayon_1km)

mapview(sinp_ea_2km, col.regions = "red") +
  mapview(rayon_2km, col.regions = "red", alpha.regions = 0.2)+
  mapview(sinp_ea_1km, col.regions = "green")+
  mapview(rayon_1km, col.regions = "green", alpha.regions = 0.4)
  

sinp_ea_2km <- sf::st_intersection(sinp,rayon_2km)
sinp_ea_2km$rayon <- "2km"
  
sinp_ea_1km <- sf::st_intersection(sinp,rayon_1km)
sinp_ea_1km$rayon <- "1km"


sinp_rayon <- bind_rows(sinp_ea_1km, sinp_ea_2km)
