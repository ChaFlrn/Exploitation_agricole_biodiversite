##%######################################################%##
#                                                          #
####   Réalisation de graphiques pour l'étude              ####
###                                                        ###
##             Date : Avril 2024                           ##
#                                                          #
##%######################################################%##

###---------------------------------------------------------#
#### Nombre de données par exploitation agricole ####
nb_obs_ea <- ggplot2::ggplot(data = nb_obs, 
                                   aes(x = annees, 
                                       y = nombre)) +
  geom_col(color = "black", fill = "blue")+
  geom_text(aes(label = nombre), vjust = 1.6, color = "white", position = position_dodge(0.9), size = 2.5) + 
  labs(
    title = "Distribution des observations, synthèse annuelle",
    subtitle = "Région Bretagne, de 2014 à 2024",
    x = "Années",
    y = "Nombre d'observations")+
  theme(plot.title = element_text(color = "black",
                                  size = 12, 
                                  face = "bold"),
        axis.title = element_text(color = "black", 
                                  size = 10, 
                                  face = "bold"),
        axis.text.x = element_text(angle = 90)) +
  theme(legend.position = "bottom",
        legend.text = element_text(size=14),
        legend.title = element_blank()) +
  facet_wrap(~ Exploitati, scale ="free")



#### Diversité taxonomique à l'échelle des règnes ####

diversite_regne <- ggplot2::ggplot(data = ana_bio, 
                                   aes(x = regne, 
                                       y = nombre, 
                                       fill = rayon)) +
  geom_col(position = 'dodge') +
  scale_fill_brewer(palette = "YlGnBu") +
  geom_text(aes(label = nombre), vjust = 1.6, color = "black", position = position_dodge(0.9), size = 3.5) + 
  labs(
    title = "Diversité des êtres vivants (au niveau du règne) en fonction de l'exploitation agricole concernée",
    subtitle = "Région Bretagne, de 2014 à 2024",
    x = "Règne (Animal, Végétal, Fongique)",
    y = "Nombre d'observations")+
  theme(plot.title = element_text(color = "black",
                                  size = 12, 
                                  face = "bold"),
        axis.title = element_text(color = "black", 
                                  size = 10, 
                                  face = "bold")) +
  theme(legend.position = "bottom",
        legend.text = element_text(size=14),
        legend.title = element_blank()) +
  facet_wrap(~ Exploitati, scale ="free")


#### Sauvegarde des graphiques ####
ggsave("Output/nb_obs_ea.jpeg",
       plot = nb_obs_ea,
       width = 11, 
       height = 8)


ggsave("Output/diversite_regne.jpeg",
plot = diversite_regne,
width = 11, 
height = 8)




