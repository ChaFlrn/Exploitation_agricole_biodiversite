#' Calcul des indicateurs de biodiversité
#' 
#' @param data_biodiv un dataframe avec en colonne 1 les exploitations (ou les ateliers) et les autres colonnes correpondent à la présence/absence des différentes espèces faunistiques et floristiques
#' @param code le nom de la colonne des ateliers de productions ou des exploitations à comparer
#' 
#' @return un dataframe avec les indicateurs de biodiversité pour chaque sujet
#' @export
#' 
#' @examples
#' \dontrun{
#' indic_biodiv(data_biodiv = data_ind, code = data_ind$Code_EA)
#' }
#' 

indic_biodiv <- function(data_biodiv, code){
  richesse_specifique <- vegan::specnumber(data_biodiv)
  indice_shannon <- vegan::diversity(data_biodiv, index = "shannon")
  indice_simpson <- vegan::diversity(data_biodiv, index = "simpson")
  indice_pielou <- indice_shannon/(SciViews::ln(richesse_specifique))
  H_max <- log2(richesse_specifique)
  recap <- data.frame(code,
                                Rs = richesse_specifique,
                                D = indice_simpson,
                                H = indice_shannon,
                                Hmax = H_max,
                                E = indice_pielou)
  
  return(recap)
}


